import Question from '../models/Question.js';

const fixedQuestions = [
  {
    question: 'Which HTTP method is commonly used to update an existing resource?',
    options: ['GET', 'POST', 'PUT', 'TRACE'],
    correctAnswer: 'PUT',
    domain: 'fullstack'
  },
  {
    question: 'In React, which hook is used to manage local component state?',
    options: ['useMemo', 'useState', 'useRef', 'useContext'],
    correctAnswer: 'useState',
    domain: 'fullstack'
  },
  {
    question: 'What does middleware do in Express.js?',
    options: ['Compiles JSX', 'Handles request/response pipeline logic', 'Creates MongoDB indexes', 'Renders CSS'],
    correctAnswer: 'Handles request/response pipeline logic',
    domain: 'fullstack'
  },
  {
    question: 'Which MongoDB operation is used to fetch multiple documents?',
    options: ['findOne()', 'insertOne()', 'find()', 'updateOne()'],
    correctAnswer: 'find()',
    domain: 'fullstack'
  },
  {
    question: 'Which status code indicates successful resource creation?',
    options: ['200', '201', '204', '301'],
    correctAnswer: '201',
    domain: 'fullstack'
  },
  {
    question: 'What is the purpose of JWT in web applications?',
    options: ['Compress images', 'Encrypt database', 'Stateless authentication', 'Bundle JavaScript'],
    correctAnswer: 'Stateless authentication',
    domain: 'fullstack'
  },
  {
    question: 'Which CSS layout model is best for one-dimensional alignment?',
    options: ['Grid', 'Flexbox', 'Table', 'Float'],
    correctAnswer: 'Flexbox',
    domain: 'fullstack'
  },
  {
    question: 'What does CORS stand for?',
    options: ['Cross-Origin Resource Sharing', 'Common Object Runtime Service', 'Code Object Rendering System', 'Cross Output Response Security'],
    correctAnswer: 'Cross-Origin Resource Sharing',
    domain: 'fullstack'
  },
  {
    question: 'Which command initializes a new Node.js project?',
    options: ['node init', 'npm init', 'npm create', 'node new'],
    correctAnswer: 'npm init',
    domain: 'fullstack'
  },
  {
    question: 'Which data format is most commonly used for REST APIs?',
    options: ['XML only', 'JSON', 'YAML only', 'CSV'],
    correctAnswer: 'JSON',
    domain: 'fullstack'
  },

  {
    question: 'Which library is widely used for numerical computation in Python?',
    options: ['NumPy', 'Flask', 'Seaborn', 'Requests'],
    correctAnswer: 'NumPy',
    domain: 'machinelearning'
  },
  {
    question: 'What is overfitting in machine learning?',
    options: ['Model performs well on train and test data', 'Model memorizes training data and performs poorly on unseen data', 'Model has too few features', 'Model uses linear regression'],
    correctAnswer: 'Model memorizes training data and performs poorly on unseen data',
    domain: 'machinelearning'
  },
  {
    question: 'Which algorithm is commonly used for classification?',
    options: ['K-Means', 'Linear Regression', 'Logistic Regression', 'Apriori'],
    correctAnswer: 'Logistic Regression',
    domain: 'machinelearning'
  },
  {
    question: 'What does a confusion matrix evaluate?',
    options: ['Network latency', 'Model training cost', 'Classification performance', 'Database consistency'],
    correctAnswer: 'Classification performance',
    domain: 'machinelearning'
  },
  {
    question: 'Which metric is best when classes are imbalanced?',
    options: ['Accuracy only', 'F1-score', 'MAE', 'R2'],
    correctAnswer: 'F1-score',
    domain: 'machinelearning'
  },
  {
    question: 'What is gradient descent used for?',
    options: ['Sorting data', 'Optimizing model parameters', 'Normalizing images', 'Encrypting tensors'],
    correctAnswer: 'Optimizing model parameters',
    domain: 'machinelearning'
  },
  {
    question: 'Which framework is popular for deep learning?',
    options: ['TensorFlow', 'Django', 'Bootstrap', 'Selenium'],
    correctAnswer: 'TensorFlow',
    domain: 'machinelearning'
  },
  {
    question: 'What is train-test split used for?',
    options: ['Parallel API calls', 'Model deployment', 'Evaluating generalization on unseen data', 'Reducing image size'],
    correctAnswer: 'Evaluating generalization on unseen data',
    domain: 'machinelearning'
  },
  {
    question: 'In supervised learning, labels are:',
    options: ['Unknown', 'Always missing', 'Known target outputs', 'Generated by optimizer'],
    correctAnswer: 'Known target outputs',
    domain: 'machinelearning'
  },
  {
    question: 'PCA is primarily used for:',
    options: ['Encryption', 'Dimensionality reduction', 'Data scraping', 'GPU scheduling'],
    correctAnswer: 'Dimensionality reduction',
    domain: 'machinelearning'
  },

  {
    question: 'Which language is primarily used for Android native development?',
    options: ['Swift', 'Kotlin', 'Dart', 'Ruby'],
    correctAnswer: 'Kotlin',
    domain: 'mobileapp'
  },
  {
    question: 'Which framework is used for cross-platform mobile apps with JavaScript?',
    options: ['React Native', 'Spring Boot', 'Laravel', 'FastAPI'],
    correctAnswer: 'React Native',
    domain: 'mobileapp'
  },
  {
    question: 'In Flutter, UI is built using:',
    options: ['Controllers', 'Widgets', 'Templates', 'Layouts.xml'],
    correctAnswer: 'Widgets',
    domain: 'mobileapp'
  },
  {
    question: 'What is APK in Android?',
    options: ['A network protocol', 'Android application package', 'An iOS bundle', 'A database engine'],
    correctAnswer: 'Android application package',
    domain: 'mobileapp'
  },
  {
    question: 'Which storage is suitable for key-value pairs on mobile?',
    options: ['SharedPreferences / AsyncStorage', 'Hadoop', 'Redis Cluster only', 'Kafka'],
    correctAnswer: 'SharedPreferences / AsyncStorage',
    domain: 'mobileapp'
  },
  {
    question: 'What is the purpose of push notifications?',
    options: ['Compile app code', 'Notify users with real-time messages', 'Encrypt photos', 'Manage DNS'],
    correctAnswer: 'Notify users with real-time messages',
    domain: 'mobileapp'
  },
  {
    question: 'Which iOS language is modern and commonly used?',
    options: ['Objective-C only', 'Swift', 'Java', 'Go'],
    correctAnswer: 'Swift',
    domain: 'mobileapp'
  },
  {
    question: 'What does offline-first design improve?',
    options: ['App icon quality', 'User experience with poor connectivity', 'CPU speed', 'Camera pixels'],
    correctAnswer: 'User experience with poor connectivity',
    domain: 'mobileapp'
  },
  {
    question: 'In mobile app architecture, MVVM stands for:',
    options: ['Model View ViewModel', 'Main View Visual Mode', 'Model Version View Memory', 'Mobile View Verification Method'],
    correctAnswer: 'Model View ViewModel',
    domain: 'mobileapp'
  },
  {
    question: 'Which tool is commonly used to debug Android apps?',
    options: ['Android Studio Logcat', 'phpMyAdmin', 'Tableau', 'Postman only'],
    correctAnswer: 'Android Studio Logcat',
    domain: 'mobileapp'
  },

  {
    question: 'What does IaaS stand for in cloud computing?',
    options: ['Internet as a Service', 'Infrastructure as a Service', 'Integration as a Service', 'Instance as a Software'],
    correctAnswer: 'Infrastructure as a Service',
    domain: 'cloud'
  },
  {
    question: 'Which cloud model provides ready-to-use software over the internet?',
    options: ['PaaS', 'SaaS', 'IaaS', 'DaaS'],
    correctAnswer: 'SaaS',
    domain: 'cloud'
  },
  {
    question: 'Auto-scaling in cloud helps to:',
    options: ['Resize images', 'Adjust resources based on demand', 'Encrypt backups', 'Increase code quality'],
    correctAnswer: 'Adjust resources based on demand',
    domain: 'cloud'
  },
  {
    question: 'Which service is best for object storage?',
    options: ['Virtual machine', 'Blob/S3 bucket storage', 'Load balancer', 'DNS zone'],
    correctAnswer: 'Blob/S3 bucket storage',
    domain: 'cloud'
  },
  {
    question: 'What is a primary benefit of cloud computing?',
    options: ['No internet needed', 'Elastic scalability', 'Guaranteed zero downtime', 'No security concerns'],
    correctAnswer: 'Elastic scalability',
    domain: 'cloud'
  },
  {
    question: 'Which cloud service typically manages containers?',
    options: ['Kubernetes service', 'CDN', 'RDBMS only', 'SMTP'],
    correctAnswer: 'Kubernetes service',
    domain: 'cloud'
  },
  {
    question: 'What does CDN mainly improve?',
    options: ['Code readability', 'Global content delivery speed', 'Database joins', 'Mobile battery life'],
    correctAnswer: 'Global content delivery speed',
    domain: 'cloud'
  },
  {
    question: 'Serverless computing means:',
    options: ['No servers exist', 'Developer manages no server infrastructure', 'Only frontend apps', 'No billing'],
    correctAnswer: 'Developer manages no server infrastructure',
    domain: 'cloud'
  },
  {
    question: 'What is multi-region deployment useful for?',
    options: ['Improved resilience and latency', 'Single-point failure', 'Higher local-only latency', 'No backup needed'],
    correctAnswer: 'Improved resilience and latency',
    domain: 'cloud'
  },
  {
    question: 'Which practice secures cloud resources best?',
    options: ['Use root account always', 'Least-privilege IAM', 'Disable logging', 'Open all ports'],
    correctAnswer: 'Least-privilege IAM',
    domain: 'cloud'
  },

  {
    question: 'What is a blockchain?',
    options: ['Centralized ledger', 'Distributed immutable ledger', 'Cloud file system', 'Relational database'],
    correctAnswer: 'Distributed immutable ledger',
    domain: 'blockchain'
  },
  {
    question: 'What is a smart contract?',
    options: ['Paper legal contract', 'Self-executing code on blockchain', 'Cloud deployment script', 'A wallet backup file'],
    correctAnswer: 'Self-executing code on blockchain',
    domain: 'blockchain'
  },
  {
    question: 'Which consensus algorithm is associated with Bitcoin?',
    options: ['Proof of Work', 'Proof of Authority', 'Raft', 'Paxos'],
    correctAnswer: 'Proof of Work',
    domain: 'blockchain'
  },
  {
    question: 'What is the purpose of a blockchain wallet?',
    options: ['Store private/public keys', 'Mine coins automatically', 'Host websites', 'Compile contracts'],
    correctAnswer: 'Store private/public keys',
    domain: 'blockchain'
  },
  {
    question: 'Gas fees in Ethereum are paid for:',
    options: ['UI design', 'Executing transactions and smart contracts', 'Buying domains', 'Data compression'],
    correctAnswer: 'Executing transactions and smart contracts',
    domain: 'blockchain'
  },
  {
    question: 'What does decentralization mean in blockchain?',
    options: ['Single trusted authority', 'Control distributed across many nodes', 'No network security', 'Only one miner'],
    correctAnswer: 'Control distributed across many nodes',
    domain: 'blockchain'
  },
  {
    question: 'What are NFTs?',
    options: ['Non-Fungible Tokens', 'Network File Tables', 'New Finance Transfers', 'Node Function Types'],
    correctAnswer: 'Non-Fungible Tokens',
    domain: 'blockchain'
  },
  {
    question: 'Which blockchain property helps prevent tampering?',
    options: ['Immutability', 'Single admin control', 'Hidden transactions only', 'Random deletion'],
    correctAnswer: 'Immutability',
    domain: 'blockchain'
  },
  {
    question: 'What is a block in blockchain?',
    options: ['A user account', 'A collection of verified transactions', 'A cloud VM', 'A CSS framework'],
    correctAnswer: 'A collection of verified transactions',
    domain: 'blockchain'
  },
  {
    question: 'Which risk should smart contracts handle carefully?',
    options: ['Reentrancy vulnerabilities', 'Font rendering', 'HTTP caching only', 'Email bounce rate'],
    correctAnswer: 'Reentrancy vulnerabilities',
    domain: 'blockchain'
  }
];

const validateDistribution = (questions) => {
  const expected = {
    fullstack: 10,
    machinelearning: 10,
    mobileapp: 10,
    cloud: 10,
    blockchain: 10
  };

  const counts = questions.reduce((acc, item) => {
    acc[item.domain] = (acc[item.domain] || 0) + 1;
    return acc;
  }, {});

  return Object.entries(expected).every(([domain, count]) => counts[domain] === count);
};

export const seedQuestionsIfEmpty = async () => {
  const existingCount = await Question.countDocuments();
  if (existingCount > 0) return;

  if (fixedQuestions.length !== 50 || !validateDistribution(fixedQuestions)) {
    throw new Error('Question seed dataset must contain exactly 50 questions with 10 per domain.');
  }

  await Question.insertMany(fixedQuestions);
  console.log('Quiz question seed completed with 50 fixed questions.');
};

export default fixedQuestions;
